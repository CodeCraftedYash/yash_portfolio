import gsap from "gsap";
import { useGSAP } from "@gsap/react";
import DrawSVGPlugin from "gsap/DrawSVGPlugin";
import flower from "../../assets/flower.png";
import { useRef } from "react";

gsap.registerPlugin(DrawSVGPlugin);

const FlowerComponent = ({
  duration,
  delay,
}: {
  duration: number;
  delay: number;
}) => {
  const svgRef = useRef<SVGSVGElement>(null);
  const flowerRef = useRef<HTMLImageElement>(null);
  useGSAP(
    () => {
      if (!svgRef.current || !flowerRef.current) return;
      const path = svgRef.current!.querySelector("path") as SVGPathElement;
      gsap.set(flowerRef.current, {
        autoAlpha: 0,
        scale:1.05
      });
      gsap.set(path, {
        drawSVG: "0% 0%",
      });
      const tl = gsap.timeline()
      tl.to(path, {
        drawSVG: "0% 100%",
        duration: duration,
        delay: delay
      })
      .to(flowerRef.current,{
        autoAlpha:1,
        duration:1,
        scale:1
      })
      .to(path,{
        autoAlpha:0,
        duration:0.5
      })
    },
    { scope: svgRef }
  );
  return (
    <div className="relative">
      <svg
        className="absolute"
        viewBox="0 0 202 198"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        ref={svgRef}
      >
        <path
          stroke="black"
          strokeWidth="2"
          fill="none"
          d="M98.5183 0.523601C97.7779 0.85045 96.4631 2.33118 95.5086 3.69677C94.6693 4.89747 93.4076 6.12958 92.2908 7.12375C91.2436 8.05597 89.4457 7.29336 88.1235 6.92194C86.542 6.47772 84.9887 5.56006 83.6256 5.2295C81.5695 4.73088 79.0459 5.14407 77.7237 5.51549C76.283 5.92019 75.0841 7.0408 74.2546 8.19468C73.412 9.36686 73.019 10.8342 72.0682 12.1565C71.1705 13.4049 70.2953 14.7961 68.8517 15.6256C67.5925 16.3491 66.17 15.9598 64.8478 15.4238C63.5747 14.9076 62.0448 14.7218 60.6383 14.9248C60.2878 14.9754 59.9797 15.212 59.7705 15.4597C58.9187 16.4677 59.1477 18.015 58.655 19.5837C58.3892 20.4297 57.8304 21.1548 57.1718 21.6909C55.9218 22.7082 53.6259 22.2294 52.2195 22.3545C50.564 22.5017 48.426 22.7247 46.1195 23.0144C43.3565 23.3614 40.9134 23.3833 39.7596 24.0011C37.8152 25.0421 36.5356 27.3402 36.2038 28.8704C35.8312 30.5891 31.9201 29.331 29.8129 29.2877C28.2177 29.2548 26.9629 30.7275 26.0529 31.7601C25.1903 32.7388 25.9675 34.8478 26.4194 36.6282C26.5164 37.0103 26.6261 37.3289 26.5456 37.7424C26.1695 39.6753 23.011 40.5479 21.2269 41.5C19.4729 42.436 19.1185 44.0145 18.8288 45.3367C18.5282 46.7087 19.3611 48.3874 19.6942 49.9993C19.9722 51.3451 19.3661 52.681 18.7483 54.2087C18.15 55.6883 17.1376 56.6428 16.6844 57.965C16.1258 59.5951 13.8443 60.1936 12.4354 61.0615C12.1103 61.2617 12.0219 61.7585 11.9785 62.1324C11.818 63.5171 12.9232 64.814 12.8873 66.1363C12.8373 67.9769 10.0459 68.6917 8.6803 69.8926C7.14542 71.2424 5.66808 73.0695 4.67639 74.3076C3.3755 75.9317 2.52834 78.3486 2.52586 80.8235C2.52403 82.6562 3.92488 83.8803 5.08124 85.2026C5.59321 85.788 5.66314 86.6065 5.62228 87.389C5.54856 88.8007 4.59344 90.0706 3.68594 91.3929C2.68587 92.85 1.45865 94.1167 0.754192 95.3547C0.412788 95.9547 0.463243 96.9221 0.626668 97.8705C0.872243 99.2955 3.09785 99.2373 4.05117 100.142C5.18911 101.223 3.5188 103.194 2.98271 104.516C2.48561 105.743 3.43461 107.483 2.98271 109.179C2.6186 110.546 2.44415 113.168 2.97776 115.123C3.34993 116.486 4.66772 117.392 5.49475 118.63C6.56509 120.233 8.13432 121.354 9.24982 122.387C10.2473 123.31 10.036 124.984 10.2428 129.8C10.3038 131.222 11.0264 131.838 11.4375 132.415C12.2946 133.618 14.2405 133.081 16.0146 133.079C16.9141 133.077 17.6278 133.819 18.2048 134.478C18.7172 135.063 18.7867 136.862 18.6641 139.09C18.5611 140.961 17.1376 142.07 16.1904 144.214C15.5605 145.64 15.4043 147.022 15.1146 148.631C14.9468 149.563 15.2359 150.409 15.5652 151.068C15.8945 151.726 16.3898 152.227 17.0893 152.474C18.5391 152.987 19.9356 152.969 21.2579 153.3C22.5533 153.624 23.6498 153.965 24.8495 154.001C26.3618 154.046 25.4722 157.09 25.6778 159.395C25.9757 162.737 25.8016 165.266 26.0071 165.925C26.2211 166.611 26.7895 167.165 27.4482 167.618C28.0712 168.047 28.9339 168.158 29.9219 168.036C31.8883 167.792 32.7323 166.838 33.2275 166.551C33.4573 166.418 33.3959 166.019 33.5593 165.81C33.9102 165.36 34.7949 165.434 35.6182 165.557C37.6554 165.86 38.8384 168.48 39.8301 170.133C40.7507 171.667 42.1366 172.61 43.5431 173.027C44.8326 173.41 46.1827 172.452 49.7656 172.408C51.5888 172.386 52.7048 173.601 53.902 174.592C55.0052 175.506 55.9238 176.735 56.9155 178.51C57.8736 180.224 58.8951 181.524 59.9277 182.64C60.8198 183.604 62.6886 182.44 64.3414 181.985C65.9694 181.536 66.9847 181.034 67.7263 181.157C69.0886 181.382 70.4438 183.664 72.1833 185.855C73.2648 187.217 74.2472 188.373 75.0334 189.696C75.4416 190.382 75.983 190.936 76.5178 191.348C77.0444 191.754 78.2882 191.191 79.6947 190.692C80.9627 190.242 82.3343 190.28 83.6974 189.909C84.5004 189.69 85.2264 189.371 85.9259 189.329C87.6475 189.226 90.4907 192.568 92.6523 194.401C93.4378 195.068 94.4698 195.311 95.3748 195.559C97.7824 196.218 101.96 193.588 104.168 192.593C105.609 191.943 105.531 189.626 106.725 188.342C107.99 186.983 110.562 189.285 112.09 189.494C113.778 189.725 115.762 189.864 119.591 188.88C121.739 188.328 123.191 187.229 124.226 185.991C125.163 184.87 125.34 183.352 126.288 182.029C127.605 180.193 131.352 178.979 133.506 178.352C135.081 177.895 136.401 178.065 136.813 177.489C138.074 175.728 137.391 173.113 137.926 172.701C139.736 171.305 143.495 172.531 145.842 172.821C149.415 173.262 151.577 173.11 153.893 172.905C155.547 172.758 158.173 171.471 160.169 169.979C161.919 168.671 161.412 166.435 161.288 164.944C161.261 164.611 161.491 164.285 161.821 164.035C163.238 162.959 164.953 163.369 169.237 163.413C170.491 163.425 171.148 163.206 171.766 163.083C172.076 163.022 172.302 162.716 172.347 162.426C172.561 161.031 170.995 158.11 170.533 156.03C170.461 155.704 170.41 155.371 170.573 155.121C171.522 153.657 174.362 154.213 175.891 153.511C176.911 153.043 177.834 152.479 178.411 151.698C179.662 150.004 178.829 148.027 178.499 146.415C178.212 145.019 177.101 143.243 176.6 141.381C176.029 139.264 176.683 137.375 176.722 136.757C176.813 135.348 179.315 135.557 181.214 135.186C183.407 134.757 185.505 134.072 186.707 133.207C187.817 132.409 185.604 129.382 184.485 127.554C184.28 127.22 184.113 126.896 184.152 126.564C184.436 124.107 189.63 122.934 191.573 121.817C194.056 120.39 196.237 116.833 196.82 115.133C197.454 113.285 196.905 110.885 196.328 109.068C195.869 107.62 194.434 106.591 192.989 105.475C191.238 104.121 190.467 103.452 190.26 102.752C190.154 102.392 190.299 101.971 190.504 101.638C191.355 100.26 193.429 100.149 195.122 99.9826C197.138 99.7852 198.713 98.747 199.872 97.5931C200.924 96.5449 199.218 94.3766 198.559 93.2215C197.782 91.8587 195.098 92.7201 193.196 92.3487C192.414 92.196 191.789 91.8114 191.172 91.5241C190.487 91.2056 190.301 90.2465 190.177 89.2597C190.014 87.9557 190.381 86.8616 190.915 86.2438C192.102 84.8729 193.434 83.3999 193.685 81.7471C193.946 80.0295 192.285 78.8587 191.377 77.6602C190.077 75.943 190.14 73.4954 188.944 71.9255C187.19 69.6232 185.931 68.7065 184.528 67.6306C183.269 66.6647 182.214 65.8961 181.925 65.3613C181.318 64.2406 183.284 63.5859 183.244 63.0089C183.146 61.5748 180.157 62.016 175.955 61.7684C175.101 61.7181 174.952 61.2781 174.868 60.9463C174.783 60.6145 174.783 60.2877 175.028 59.8741C175.623 58.8718 176.596 58.1384 177.132 57.4797C178.099 56.2913 177.344 54.3449 177.178 52.6116C177.103 51.8329 176.437 50.8783 175.901 49.7245C175.135 48.0756 176.517 45.9261 176.722 44.3166C176.842 43.3774 176.683 42.5387 176.436 41.8801C176.164 41.1535 175.447 40.7212 174.747 40.4736C173.304 39.9627 171.901 41.2115 170.579 41.5445C170.257 41.6256 169.92 41.4641 169.793 41.2177C169.141 39.9591 170.49 38.4977 170.779 37.0528C171.162 35.1443 170.742 33.793 170.081 32.4299C169.711 31.6671 169.338 30.9826 168.803 30.5703C167.738 29.7488 166.206 29.6628 164.021 29.5353C163.065 29.4795 162.16 29.742 161.254 29.6603C159.657 29.5163 159.268 27.1074 158.691 25.7852C158.068 24.3569 156.549 23.4724 154.16 22.6875C151.564 21.835 148.477 22.8088 146.19 22.6033C144.255 22.4294 141.95 22.8088 140.122 22.1935C138.376 21.6054 138.057 19.679 137.396 18.3567C136.735 17.0345 136.24 16.044 135.829 15.5897C134.94 14.6069 133.026 16.0391 131.54 16.3288C129.427 16.7408 127.91 15.7122 126.504 15.0536C124.968 14.3344 124.686 12.3348 124.066 10.7228C123.803 10.0409 123.693 9.35846 123.447 8.69981C123.175 7.97324 122.458 7.54098 121.595 7.29336C119.33 6.64354 116.941 7.45679 113.88 7.86782C112.311 8.07861 110.825 8.52648 108.391 8.654C106.638 8.74583 104.882 7.37755 103.722 6.38833C102.066 4.97589 101.079 2.84127 100.214 1.8471C99.5979 1.59824 99.1794 1.1872 98.8922 0.651121C98.6867 0.441888 98.3598 0.360175 97.7755 1.01883"
        />
      </svg>
      <img src={flower} alt="flower" ref={flowerRef} />
    </div>
  );
};

export default FlowerComponent;
